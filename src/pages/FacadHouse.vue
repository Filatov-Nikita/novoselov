<template>
  <div
    class="tw-h-screen tw-min-h-[700px] md:tw-min-h-[1000px] lg:tw-min-h-[800px] xl:tw-min-h-[800px] tw-overflow-hidden tw-relative tw-bg-primary">
    <Header class="tw-absolute tw-inset-x-0 tw-top-0" />
    <div
      class="tw-absolute tw-inset-0 tw-z-[5] tw-overflow-x-auto tw-pt-80 xl:tw-pt-[102px] tw-mb-[137px]">
      <div class="storey-popup" v-if="activeStorey">
        <div>
          <p class="tw-text-xl tw-text-secondary">
            {{ activeStorey.entrance }}
          </p>
          <p>секция</p>
        </div>
        <div>
          <p class="tw-text-xl tw-text-secondary">
            {{ activeStorey.number }}
          </p>
          <p>этаж</p>
        </div>
        <div>
          <p class="tw-text-xl tw-text-secondary">
            {{ activeStorey.flats_counters.free }}
          </p>
          <p>
            квартир <br />
            свободно
          </p>
        </div>
      </div>
      <HousePlan
        v-if="
          $grid.breakpoint === '' ||
          $grid.breakpoint === 'sm' ||
          $grid.breakpoint === 'md'
        "
        tappable
        :activeStorey="hoverStorey"
        :storeys="storeys"
        ratio="xMidYMid slice"
        d="M206 192.643V177.14L315.524 200.395L538 169V186.442L315.524 219L206 192.643Z"
        :paths="paths.mobile"
        width="769"
        height="690"
        :offset="17"
        :image="require('@/assets/images/house-mobile.jpg')"
        @enter="onEnter">
        <template #flags>
          <path d="M470 120L442.686 100.518C441.314 99.519 440.19 98.3278 439.314 96.9444C438.438 95.5611 438 94.0241 438 92.3333L438 43.9167C438 42.0146 438.671 40.3863 440.014 39.0318C441.357 37.6773 442.971 37 444.857 37L495.143 37C497.029 37 498.643 37.6773 499.986 39.0318C501.329 40.3863 502 42.0146 502 43.9167L502 92.3333C502 94.0241 501.562 95.5611 500.686 96.9444C499.81 98.3278 498.686 99.519 497.314 100.518L470 120Z" fill="#F5F5F5"/>
          <path d="M453.684 54.3408L454.894 54.498C454.762 55.332 454.423 55.986 453.876 56.46C453.333 56.9294 452.666 57.1641 451.873 57.1641C450.879 57.1641 450.08 56.8405 449.473 56.1934C448.872 55.5417 448.571 54.6097 448.571 53.3975C448.571 52.6136 448.701 51.9277 448.961 51.3398C449.221 50.752 449.615 50.3122 450.143 50.0205C450.677 49.7243 451.255 49.5762 451.88 49.5762C452.668 49.5762 453.313 49.7767 453.814 50.1777C454.316 50.5742 454.637 51.1393 454.778 51.873L453.582 52.0576C453.468 51.57 453.265 51.2031 452.973 50.957C452.686 50.7109 452.338 50.5879 451.928 50.5879C451.308 50.5879 450.804 50.8112 450.417 51.2578C450.029 51.6999 449.836 52.4017 449.836 53.3633C449.836 54.3385 450.023 55.0472 450.396 55.4893C450.77 55.9313 451.258 56.1523 451.859 56.1523C452.342 56.1523 452.746 56.0042 453.069 55.708C453.393 55.4118 453.598 54.9561 453.684 54.3408ZM460.637 54.6621L461.908 54.8193C461.708 55.5622 461.336 56.1387 460.794 56.5488C460.252 56.959 459.559 57.1641 458.716 57.1641C457.654 57.1641 456.811 56.8382 456.187 56.1865C455.567 55.5303 455.257 54.612 455.257 53.4316C455.257 52.2103 455.571 51.2624 456.2 50.5879C456.829 49.9134 457.645 49.5762 458.648 49.5762C459.618 49.5762 460.411 49.9066 461.026 50.5674C461.642 51.2282 461.949 52.1579 461.949 53.3564C461.949 53.4294 461.947 53.5387 461.942 53.6846H456.528C456.574 54.4821 456.8 55.0928 457.205 55.5166C457.611 55.9404 458.117 56.1523 458.723 56.1523C459.174 56.1523 459.559 56.0339 459.878 55.7969C460.197 55.5599 460.45 55.1816 460.637 54.6621ZM456.597 52.6729H460.65C460.596 52.0622 460.441 51.6042 460.186 51.2988C459.794 50.8249 459.286 50.5879 458.661 50.5879C458.096 50.5879 457.62 50.777 457.233 51.1553C456.85 51.5335 456.638 52.0394 456.597 52.6729ZM463.173 49.7402H464.404V52.8779C464.796 52.8779 465.069 52.8027 465.224 52.6523C465.383 52.502 465.616 52.0645 465.921 51.3398C466.163 50.7656 466.359 50.3874 466.509 50.2051C466.66 50.0228 466.833 49.8997 467.029 49.8359C467.225 49.7721 467.539 49.7402 467.972 49.7402H468.218V50.7588L467.876 50.752C467.553 50.752 467.345 50.7998 467.254 50.8955C467.159 50.9958 467.013 51.2943 466.817 51.791C466.63 52.265 466.459 52.5931 466.304 52.7754C466.149 52.9577 465.91 53.124 465.586 53.2744C466.115 53.4157 466.634 53.9079 467.145 54.751L468.492 57H467.138L465.826 54.751C465.557 54.2998 465.322 54.0036 465.121 53.8623C464.921 53.7165 464.682 53.6436 464.404 53.6436V57H463.173V49.7402ZM469.046 49.7402H470.276V55.9883H473.68V49.7402H474.911V55.9883H475.704V59.0576H474.692V57H469.046V49.7402ZM476.77 49.7402H478.001V55.2773L481.412 49.7402H482.738V57H481.508V51.4971L478.097 57H476.77V49.7402ZM490.026 49.7402V57H488.802V54.1699H488.091C487.658 54.1699 487.335 54.2269 487.12 54.3408C486.911 54.4502 486.603 54.8079 486.197 55.4141L485.124 57H483.6L484.926 55.0449C485.332 54.4479 485.735 54.1107 486.136 54.0332C485.434 53.9375 484.912 53.6846 484.571 53.2744C484.233 52.8643 484.065 52.3926 484.065 51.8594C484.065 51.2305 484.286 50.7201 484.728 50.3281C485.174 49.9362 485.819 49.7402 486.662 49.7402H490.026ZM488.802 50.7588H487.052C486.318 50.7588 485.844 50.8727 485.63 51.1006C485.42 51.3285 485.316 51.5951 485.316 51.9004C485.316 52.3333 485.471 52.6523 485.78 52.8574C486.095 53.0579 486.649 53.1582 487.442 53.1582H488.802V50.7588Z" fill="#9BA5B0"/>
          <path d="M472.048 68.8H473.416V94H470.428V72.292L464.632 74.632V71.68L472.048 68.8Z" fill="#18283A"/>
          <path d="M690 151L662.686 131.518C661.314 130.519 660.19 129.328 659.314 127.944C658.438 126.561 658 125.024 658 123.333L658 74.9167C658 73.0146 658.671 71.3863 660.014 70.0318C661.357 68.6773 662.971 68 664.857 68L715.143 68C717.029 68 718.643 68.6773 719.986 70.0318C721.329 71.3863 722 73.0146 722 74.9167L722 123.333C722 125.024 721.562 126.561 720.686 127.944C719.81 129.328 718.686 130.519 717.314 131.518L690 151Z" fill="#F5F5F5"/>
          <path d="M673.684 85.3408L674.894 85.498C674.762 86.332 674.423 86.986 673.876 87.46C673.333 87.9294 672.666 88.1641 671.873 88.1641C670.879 88.1641 670.08 87.8405 669.473 87.1934C668.872 86.5417 668.571 85.6097 668.571 84.3975C668.571 83.6136 668.701 82.9277 668.961 82.3398C669.221 81.752 669.615 81.3122 670.143 81.0205C670.677 80.7243 671.255 80.5762 671.88 80.5762C672.668 80.5762 673.313 80.7767 673.814 81.1777C674.316 81.5742 674.637 82.1393 674.778 82.873L673.582 83.0576C673.468 82.57 673.265 82.2031 672.973 81.957C672.686 81.7109 672.338 81.5879 671.928 81.5879C671.308 81.5879 670.804 81.8112 670.417 82.2578C670.029 82.6999 669.836 83.4017 669.836 84.3633C669.836 85.3385 670.023 86.0472 670.396 86.4893C670.77 86.9313 671.258 87.1523 671.859 87.1523C672.342 87.1523 672.746 87.0042 673.069 86.708C673.393 86.4118 673.598 85.9561 673.684 85.3408ZM680.637 85.6621L681.908 85.8193C681.708 86.5622 681.336 87.1387 680.794 87.5488C680.252 87.959 679.559 88.1641 678.716 88.1641C677.654 88.1641 676.811 87.8382 676.187 87.1865C675.567 86.5303 675.257 85.612 675.257 84.4316C675.257 83.2103 675.571 82.2624 676.2 81.5879C676.829 80.9134 677.645 80.5762 678.648 80.5762C679.618 80.5762 680.411 80.9066 681.026 81.5674C681.642 82.2282 681.949 83.1579 681.949 84.3564C681.949 84.4294 681.947 84.5387 681.942 84.6846H676.528C676.574 85.4821 676.8 86.0928 677.205 86.5166C677.611 86.9404 678.117 87.1523 678.723 87.1523C679.174 87.1523 679.559 87.0339 679.878 86.7969C680.197 86.5599 680.45 86.1816 680.637 85.6621ZM676.597 83.6729H680.65C680.596 83.0622 680.441 82.6042 680.186 82.2988C679.794 81.8249 679.286 81.5879 678.661 81.5879C678.096 81.5879 677.62 81.777 677.233 82.1553C676.85 82.5335 676.638 83.0394 676.597 83.6729ZM683.173 80.7402H684.404V83.8779C684.796 83.8779 685.069 83.8027 685.224 83.6523C685.383 83.502 685.616 83.0645 685.921 82.3398C686.163 81.7656 686.359 81.3874 686.509 81.2051C686.66 81.0228 686.833 80.8997 687.029 80.8359C687.225 80.7721 687.539 80.7402 687.972 80.7402H688.218V81.7588L687.876 81.752C687.553 81.752 687.345 81.7998 687.254 81.8955C687.159 81.9958 687.013 82.2943 686.817 82.791C686.63 83.265 686.459 83.5931 686.304 83.7754C686.149 83.9577 685.91 84.124 685.586 84.2744C686.115 84.4157 686.634 84.9079 687.145 85.751L688.492 88H687.138L685.826 85.751C685.557 85.2998 685.322 85.0036 685.121 84.8623C684.921 84.7165 684.682 84.6436 684.404 84.6436V88H683.173V80.7402ZM689.046 80.7402H690.276V86.9883H693.68V80.7402H694.911V86.9883H695.704V90.0576H694.692V88H689.046V80.7402ZM696.77 80.7402H698.001V86.2773L701.412 80.7402H702.738V88H701.508V82.4971L698.097 88H696.77V80.7402ZM710.026 80.7402V88H708.802V85.1699H708.091C707.658 85.1699 707.335 85.2269 707.12 85.3408C706.911 85.4502 706.603 85.8079 706.197 86.4141L705.124 88H703.6L704.926 86.0449C705.332 85.4479 705.735 85.1107 706.136 85.0332C705.434 84.9375 704.912 84.6846 704.571 84.2744C704.233 83.8643 704.065 83.3926 704.065 82.8594C704.065 82.2305 704.286 81.7201 704.728 81.3281C705.174 80.9362 705.819 80.7402 706.662 80.7402H710.026ZM708.802 81.7588H707.052C706.318 81.7588 705.844 81.8727 705.63 82.1006C705.42 82.3285 705.316 82.5951 705.316 82.9004C705.316 83.3333 705.471 83.6523 705.78 83.8574C706.095 84.0579 706.649 84.1582 707.442 84.1582H708.802V81.7588Z" fill="#9BA5B0"/>
          <path d="M699.445 122.12V125H680.545V122.84L687.853 116.468C691.237 113.516 693.397 111.5 694.333 110.42C695.293 109.34 695.773 108.188 695.773 106.964C695.773 105.572 695.257 104.444 694.225 103.58C693.193 102.692 691.813 102.248 690.085 102.248C688.357 102.248 686.965 102.716 685.909 103.652C684.853 104.564 684.145 105.86 683.785 107.54H680.761C681.121 105.044 682.153 103.064 683.857 101.6C685.561 100.136 687.685 99.404 690.229 99.404C692.773 99.404 694.825 100.112 696.385 101.528C697.969 102.944 698.761 104.72 698.761 106.856C698.761 108.584 698.185 110.144 697.033 111.536C695.905 112.904 693.661 115.04 690.301 117.944L685.477 122.12H699.445Z" fill="#18283A"/>
        </template>
      </HousePlan>
      <HousePlan
        v-else
        :activeStorey="hoverStorey"
        :storeys="storeys"
        ratio="xMidYMid slice"
        d="M1137 254.736V234.581L1296.01 264.814L1619 224V246.674L1296.01 289L1137 254.736Z"
        width="1920"
        height="720"
        :offset="22"
        :paths="paths.desktop"
        :image="require('@/assets/images/house-1.jpg')"
        @enter="onEnter"
        @leave="onLeave"
      >
        <template #flags>
          <path d="M871 103L843.686 83.5181C842.314 82.519 841.19 81.3278 840.314 79.9444C839.438 78.5611 839 77.0241 839 75.3333L839 26.9167C839 25.0146 839.671 23.3863 841.014 22.0318C842.357 20.6773 843.971 20 845.857 20L896.143 20C898.029 20 899.643 20.6773 900.986 22.0318C902.329 23.3863 903 25.0146 903 26.9167L903 75.3333C903 77.0241 902.562 78.5611 901.686 79.9444C900.81 81.3278 899.686 82.519 898.314 83.5181L871 103Z" fill="#F5F5F5"/>
          <path d="M854.684 37.3408L855.894 37.498C855.762 38.332 855.423 38.986 854.876 39.46C854.333 39.9294 853.666 40.1641 852.873 40.1641C851.879 40.1641 851.08 39.8405 850.473 39.1934C849.872 38.5417 849.571 37.6097 849.571 36.3975C849.571 35.6136 849.701 34.9277 849.961 34.3398C850.221 33.752 850.615 33.3122 851.143 33.0205C851.677 32.7243 852.255 32.5762 852.88 32.5762C853.668 32.5762 854.313 32.7767 854.814 33.1777C855.316 33.5742 855.637 34.1393 855.778 34.873L854.582 35.0576C854.468 34.57 854.265 34.2031 853.973 33.957C853.686 33.7109 853.338 33.5879 852.928 33.5879C852.308 33.5879 851.804 33.8112 851.417 34.2578C851.029 34.6999 850.836 35.4017 850.836 36.3633C850.836 37.3385 851.023 38.0472 851.396 38.4893C851.77 38.9313 852.258 39.1523 852.859 39.1523C853.342 39.1523 853.746 39.0042 854.069 38.708C854.393 38.4118 854.598 37.9561 854.684 37.3408ZM861.637 37.6621L862.908 37.8193C862.708 38.5622 862.336 39.1387 861.794 39.5488C861.252 39.959 860.559 40.1641 859.716 40.1641C858.654 40.1641 857.811 39.8382 857.187 39.1865C856.567 38.5303 856.257 37.612 856.257 36.4316C856.257 35.2103 856.571 34.2624 857.2 33.5879C857.829 32.9134 858.645 32.5762 859.648 32.5762C860.618 32.5762 861.411 32.9066 862.026 33.5674C862.642 34.2282 862.949 35.1579 862.949 36.3564C862.949 36.4294 862.947 36.5387 862.942 36.6846H857.528C857.574 37.4821 857.8 38.0928 858.205 38.5166C858.611 38.9404 859.117 39.1523 859.723 39.1523C860.174 39.1523 860.559 39.0339 860.878 38.7969C861.197 38.5599 861.45 38.1816 861.637 37.6621ZM857.597 35.6729H861.65C861.596 35.0622 861.441 34.6042 861.186 34.2988C860.794 33.8249 860.286 33.5879 859.661 33.5879C859.096 33.5879 858.62 33.777 858.233 34.1553C857.85 34.5335 857.638 35.0394 857.597 35.6729ZM864.173 32.7402H865.404V35.8779C865.796 35.8779 866.069 35.8027 866.224 35.6523C866.383 35.502 866.616 35.0645 866.921 34.3398C867.163 33.7656 867.359 33.3874 867.509 33.2051C867.66 33.0228 867.833 32.8997 868.029 32.8359C868.225 32.7721 868.539 32.7402 868.972 32.7402H869.218V33.7588L868.876 33.752C868.553 33.752 868.345 33.7998 868.254 33.8955C868.159 33.9958 868.013 34.2943 867.817 34.791C867.63 35.265 867.459 35.5931 867.304 35.7754C867.149 35.9577 866.91 36.124 866.586 36.2744C867.115 36.4157 867.634 36.9079 868.145 37.751L869.492 40H868.138L866.826 37.751C866.557 37.2998 866.322 37.0036 866.121 36.8623C865.921 36.7165 865.682 36.6436 865.404 36.6436V40H864.173V32.7402ZM870.046 32.7402H871.276V38.9883H874.68V32.7402H875.911V38.9883H876.704V42.0576H875.692V40H870.046V32.7402ZM877.77 32.7402H879.001V38.2773L882.412 32.7402H883.738V40H882.508V34.4971L879.097 40H877.77V32.7402ZM891.026 32.7402V40H889.802V37.1699H889.091C888.658 37.1699 888.335 37.2269 888.12 37.3408C887.911 37.4502 887.603 37.8079 887.197 38.4141L886.124 40H884.6L885.926 38.0449C886.332 37.4479 886.735 37.1107 887.136 37.0332C886.434 36.9375 885.912 36.6846 885.571 36.2744C885.233 35.8643 885.065 35.3926 885.065 34.8594C885.065 34.2305 885.286 33.7201 885.728 33.3281C886.174 32.9362 886.819 32.7402 887.662 32.7402H891.026ZM889.802 33.7588H888.052C887.318 33.7588 886.844 33.8727 886.63 34.1006C886.42 34.3285 886.316 34.5951 886.316 34.9004C886.316 35.3333 886.471 35.6523 886.78 35.8574C887.095 36.0579 887.649 36.1582 888.442 36.1582H889.802V33.7588Z" fill="#9BA5B0"/>
          <path d="M873.048 51.8H874.416V77H871.428V55.292L865.632 57.632V54.68L873.048 51.8Z" fill="#18283A"/>
          <path d="M1106 134L1078.69 114.518C1077.31 113.519 1076.19 112.328 1075.31 110.944C1074.44 109.561 1074 108.024 1074 106.333L1074 57.9167C1074 56.0146 1074.67 54.3863 1076.01 53.0318C1077.36 51.6773 1078.97 51 1080.86 51L1131.14 51C1133.03 51 1134.64 51.6773 1135.99 53.0318C1137.33 54.3863 1138 56.0146 1138 57.9167L1138 106.333C1138 108.024 1137.56 109.561 1136.69 110.944C1135.81 112.328 1134.69 113.519 1133.31 114.518L1106 134Z" fill="#F5F5F5"/>
          <path d="M1089.68 68.3408L1090.89 68.498C1090.76 69.332 1090.42 69.986 1089.88 70.46C1089.33 70.9294 1088.67 71.1641 1087.87 71.1641C1086.88 71.1641 1086.08 70.8405 1085.47 70.1934C1084.87 69.5417 1084.57 68.6097 1084.57 67.3975C1084.57 66.6136 1084.7 65.9277 1084.96 65.3398C1085.22 64.752 1085.61 64.3122 1086.14 64.0205C1086.68 63.7243 1087.26 63.5762 1087.88 63.5762C1088.67 63.5762 1089.31 63.7767 1089.81 64.1777C1090.32 64.5742 1090.64 65.1393 1090.78 65.873L1089.58 66.0576C1089.47 65.57 1089.27 65.2031 1088.97 64.957C1088.69 64.7109 1088.34 64.5879 1087.93 64.5879C1087.31 64.5879 1086.8 64.8112 1086.42 65.2578C1086.03 65.6999 1085.84 66.4017 1085.84 67.3633C1085.84 68.3385 1086.02 69.0472 1086.4 69.4893C1086.77 69.9313 1087.26 70.1523 1087.86 70.1523C1088.34 70.1523 1088.75 70.0042 1089.07 69.708C1089.39 69.4118 1089.6 68.9561 1089.68 68.3408ZM1096.64 68.6621L1097.91 68.8193C1097.71 69.5622 1097.34 70.1387 1096.79 70.5488C1096.25 70.959 1095.56 71.1641 1094.72 71.1641C1093.65 71.1641 1092.81 70.8382 1092.19 70.1865C1091.57 69.5303 1091.26 68.612 1091.26 67.4316C1091.26 66.2103 1091.57 65.2624 1092.2 64.5879C1092.83 63.9134 1093.64 63.5762 1094.65 63.5762C1095.62 63.5762 1096.41 63.9066 1097.03 64.5674C1097.64 65.2282 1097.95 66.1579 1097.95 67.3564C1097.95 67.4294 1097.95 67.5387 1097.94 67.6846H1092.53C1092.57 68.4821 1092.8 69.0928 1093.21 69.5166C1093.61 69.9404 1094.12 70.1523 1094.72 70.1523C1095.17 70.1523 1095.56 70.0339 1095.88 69.7969C1096.2 69.5599 1096.45 69.1816 1096.64 68.6621ZM1092.6 66.6729H1096.65C1096.6 66.0622 1096.44 65.6042 1096.19 65.2988C1095.79 64.8249 1095.29 64.5879 1094.66 64.5879C1094.1 64.5879 1093.62 64.777 1093.23 65.1553C1092.85 65.5335 1092.64 66.0394 1092.6 66.6729ZM1099.17 63.7402H1100.4V66.8779C1100.8 66.8779 1101.07 66.8027 1101.22 66.6523C1101.38 66.502 1101.62 66.0645 1101.92 65.3398C1102.16 64.7656 1102.36 64.3874 1102.51 64.2051C1102.66 64.0228 1102.83 63.8997 1103.03 63.8359C1103.22 63.7721 1103.54 63.7402 1103.97 63.7402H1104.22V64.7588L1103.88 64.752C1103.55 64.752 1103.35 64.7998 1103.25 64.8955C1103.16 64.9958 1103.01 65.2943 1102.82 65.791C1102.63 66.265 1102.46 66.5931 1102.3 66.7754C1102.15 66.9577 1101.91 67.124 1101.59 67.2744C1102.11 67.4157 1102.63 67.9079 1103.14 68.751L1104.49 71H1103.14L1101.83 68.751C1101.56 68.2998 1101.32 68.0036 1101.12 67.8623C1100.92 67.7165 1100.68 67.6436 1100.4 67.6436V71H1099.17V63.7402ZM1105.05 63.7402H1106.28V69.9883H1109.68V63.7402H1110.91V69.9883H1111.7V73.0576H1110.69V71H1105.05V63.7402ZM1112.77 63.7402H1114V69.2773L1117.41 63.7402H1118.74V71H1117.51V65.4971L1114.1 71H1112.77V63.7402ZM1126.03 63.7402V71H1124.8V68.1699H1124.09C1123.66 68.1699 1123.33 68.2269 1123.12 68.3408C1122.91 68.4502 1122.6 68.8079 1122.2 69.4141L1121.12 71H1119.6L1120.93 69.0449C1121.33 68.4479 1121.73 68.1107 1122.14 68.0332C1121.43 67.9375 1120.91 67.6846 1120.57 67.2744C1120.23 66.8643 1120.06 66.3926 1120.06 65.8594C1120.06 65.2305 1120.29 64.7201 1120.73 64.3281C1121.17 63.9362 1121.82 63.7402 1122.66 63.7402H1126.03ZM1124.8 64.7588H1123.05C1122.32 64.7588 1121.84 64.8727 1121.63 65.1006C1121.42 65.3285 1121.32 65.5951 1121.32 65.9004C1121.32 66.3333 1121.47 66.6523 1121.78 66.8574C1122.09 67.0579 1122.65 67.1582 1123.44 67.1582H1124.8V64.7588Z" fill="#9BA5B0"/>
          <path d="M1115.44 105.12V108H1096.54V105.84L1103.85 99.468C1107.24 96.516 1109.4 94.5 1110.33 93.42C1111.29 92.34 1111.77 91.188 1111.77 89.964C1111.77 88.572 1111.26 87.444 1110.22 86.58C1109.19 85.692 1107.81 85.248 1106.08 85.248C1104.36 85.248 1102.96 85.716 1101.91 86.652C1100.85 87.564 1100.14 88.86 1099.78 90.54H1096.76C1097.12 88.044 1098.15 86.064 1099.86 84.6C1101.56 83.136 1103.68 82.404 1106.23 82.404C1108.77 82.404 1110.82 83.112 1112.38 84.528C1113.97 85.944 1114.76 87.72 1114.76 89.856C1114.76 91.584 1114.18 93.144 1113.03 94.536C1111.9 95.904 1109.66 98.04 1106.3 100.944L1101.48 105.12H1115.44Z" fill="#18283A"/>
        </template>
      </HousePlan>
    </div>
    <Footer class="tw-absolute tw-inset-x-0 tw-bottom-0 tw-z-10" />
  </div>
</template>

<script>
import HousePlan from "@/components/HousePlan.vue";

export default {
  data() {
    return {
      entrance: null,
      storeysMap: new Map(),
      activeStorey: null,
      hoverStorey: null,
      timer: null,
      paths: {
        mobile: {
          first: [
            "M286.18 687.62L180.622 678.431L180.623 643.6L286.181 649.886L595.18 623.271L595.179 659.554L286.18 687.62Z",
            "M286.181 648.436L180.623 642.634L180.624 609.093L286.182 613.121L595.181 592.794L595.18 622.789L286.181 648.436Z",
            "M286.182 612.636L180.624 608.284L180.624 579.742L286.183 580.706L595.181 564.734L595.181 591.825L286.182 612.636Z",
            "M286.183 580.225L180.624 578.776L180.625 545.88L286.184 546.36L595.182 536.193L595.181 563.767L286.183 580.225Z",
            "M286.184 545.876L180.626 545.396L180.627 512.983L286.185 512.497L595.183 508.134L595.182 535.225L286.184 545.876Z",
            "M286.185 511.53L180.626 512.016L180.627 480.571L286.186 480.57L595.184 477.658L595.183 507.167L286.185 511.53Z",
            "M286.186 479.603L180.627 479.606L180.628 449.612L286.187 448.642L595.185 450.568L595.184 477.176L286.186 479.603Z",
            "M286.186 447.673L180.628 449.127L180.629 415.747L286.187 414.777L595.185 421.541L595.184 449.599L286.186 447.673Z",
            "M286.187 413.81L180.629 415.264L180.63 385.271L286.188 380.913L595.186 394.451L595.185 420.574L286.187 413.81Z",
            "M286.188 380.43L180.63 384.786L180.631 353.826L286.189 348.017L595.187 366.876L595.186 393.967L286.188 380.43Z",
            "M286.189 347.533L180.631 352.856L180.632 320.929L286.19 314.636L595.188 337.365L595.187 365.907L286.189 347.533Z",
            "M286.19 314.152L180.631 320.444L180.152 289.967L286.191 278.839L595.188 309.307L595.188 336.881L286.19 314.152Z",
            "M286.191 278.353L180.153 289.483L180.633 253.684L286.672 244.973L594.709 279.796L595.188 308.822L286.191 278.353Z",
            "M286.672 244.006L180.633 252.717L180.634 222.239L286.673 212.077L594.71 252.705L594.709 278.828L286.672 244.006Z",
            "M286.673 211.11L180.634 221.272L180.155 189.343L286.674 176.762L595.191 222.229L595.19 251.255L286.673 211.11Z",
            "M286.674 175.311L179.569 188.376L179.57 156.931L286.675 143.381L595.192 194.169L595.191 220.776L286.674 175.311Z",
            "M286.675 142.415L179.57 155.963L179.57 124.518L286.676 109.518L596.916 164.66L596.915 192.718L286.675 142.415Z",
            "M286.675 109.035L179.57 124.034L179.571 92.1066L286.676 73.7191L596.917 130.796L596.916 163.211L286.675 109.035Z",

            "M616.133 622.868V597.929L750.633 587.857V612.796L616.133 622.868Z",
            "M616.133 597.451V569.155L750.633 561.961V587.536L616.133 597.451Z",
            "M616.133 568.672V540.856L750.633 535.58V561.478L616.133 568.672Z",
            "M616.133 540.222V512.559L750.633 508.723V534.869L616.133 540.222Z",
            "M616.133 512.082V484.028L750.633 483.307V508.245L616.133 512.082Z",
            "M616.133 483.307V455.234L750.633 456.45V482.828L616.133 483.307Z",
            "M616.133 455.009V426.713L750.633 429.111V455.968L616.133 455.009Z",
            "M616.133 426.235V397.939L750.633 403.215V428.633L616.133 426.235Z",
            "M616.133 397.459V369.643L750.633 376.357V402.734L616.133 397.459Z",
            "M616.133 369.164V341.348L750.633 350.46V375.878L616.133 369.164Z",
            "M616.133 340.715V312.572L750.633 323.124V349.98L616.133 340.715Z",
            "M616.133 312.092V283.316L750.633 297.225V322.643L616.133 312.092Z",
            "M616.133 282.837V254.301L750.633 270.847V296.745L616.133 282.837Z",
            "M616.133 254.062V226.246L750.633 244.74V270.369L616.133 254.062Z",
            "M616.133 225.766V197.949L750.633 219.051V244.47L616.133 225.766Z",
            "M616.133 197.47V170.133L750.633 191.714V218.572L616.133 197.47Z",
            "M616.133 169.653V138L750.633 162.459V191.235L616.133 169.653Z",
          ],
          second: [],
        },
        desktop: {
          first: [
            "M689 715.999L579 706.499L579 670.499L689 676.999L1011 649.5L1011 687.001L689 715.999Z",
            "M689 675.5L579 669.5L579 634.834L689 639L1011 618L1011 649.001L689 675.5Z",
            "M689 638.501L579 634L579 604.5L689 605.5L1011 589L1011 617L689 638.501Z",
            "M689 605.001L579 603.501L579 569.501L689 570L1011 559.5L1011 588L689 605.001Z",
            "M689 569.5L579 569L579 535.5L689 535.001L1011 530.5L1011 558.5L689 569.5Z",
            "M689 534L579 534.5L579 502L689 502.001L1011 499L1011 529.5L689 534Z",
            "M689 501L579 501L579 470L689 469L1011 471L1011 498.5L689 501Z",
            "M689 468.001L579 469.5L579 435L689 434L1011 441L1011 470L689 468.001Z",
            "M689 433.001L579 434.5L579 403.501L689 399L1011 413.001L1011 440L689 433.001Z",
            "M689 398.501L579 403L579 371.001L689 365L1011 384.501L1011 412.501L689 398.501Z",
            "M689 364.501L579 370L579 337.001L689 330.5L1011 354.001L1011 383.501L689 364.501Z",
            "M689 330L579 336.5L578.5 305.001L689 293.502L1011 325.001L1011 353.5L689 330Z",
            "M689 293L578.5 304.5L579 267.5L689.5 258.499L1010.5 294.5L1011 324.5L689 293Z",
            "M689.5 257.5L579 266.5L579 235L689.5 224.5L1010.5 266.5L1010.5 293.5L689.5 257.5Z",
            "M689.5 223.5L579 234L578.5 201L689.5 188L1011 235L1011 265L689.5 223.5Z",
            "M689.5 186.5L577.889 200.001L577.889 167.501L689.5 153.5L1011 206L1011 233.5L689.5 186.5Z",
            "M689.5 152.5L577.889 166.5L577.889 134L689.5 118.5L1012.8 175.5L1012.8 204.5L689.5 152.5Z",
            "M689.5 118L577.889 133.5L577.889 100.501L689.5 81.4995L1012.8 140.5L1012.8 174.003L689.5 118Z",

            "M1032 649V623L1166.5 612.5V638.5L1032 649Z",
            "M1032 622.5V593L1166.5 585.5V612.163L1032 622.5Z",
            "M1032 592.5V563.5L1166.5 558V585L1032 592.5Z",
            "M1032 562.84V534L1166.5 530V557.259L1032 562.84Z",
            "M1032 533.5V504.252L1166.5 503.5V529.5L1032 533.5Z",
            "M1032 503.5V474.232L1166.5 475.5V503L1032 503.5Z",
            "M1032 474V444.5L1166.5 447V475L1032 474Z",
            "M1032 444V414.5L1166.5 420V446.5L1032 444Z",
            "M1032 414V385L1166.5 392V419.5L1032 414Z",
            "M1032 384.5V355.5L1166.5 365V391.5L1032 384.5Z",
            "M1032 354.84V325.5L1166.5 336.501V364.5L1032 354.84Z",
            "M1032 325V295L1166.5 309.5V336L1032 325Z",
            "M1032 294.5V264.75L1166.5 282V309L1032 294.5Z",
            "M1032 264.5V235.5L1166.5 254.78V281.5L1032 264.5Z",
            "M1032 235V206L1166.5 228V254.5L1032 235Z",
            "M1032 205.5V177L1166.5 199.5V227.5L1032 205.5Z",
            "M1032 176.5V143.5L1166.5 169V199L1032 176.5Z",
          ],
        },
      },
    };
  },
  created() {
    this.getEntrance();
  },
  methods: {
    async getEntrance() {
      this.entrance = await this.$store.dispatch("entrances/entrancesOne", {
        id: 1,
      });
    },
    async onEnter(storeyId) {
      this.hoverStorey = { id: storeyId };

      if (this.storeysMap.has(storeyId)) {
        this.activeStorey = this.storeysMap.get(storeyId);
      } else {
        this.activeStorey = await this.$store.dispatch("storeys/storeysOne", {
          id: storeyId,
        });
        this.storeysMap.set(storeyId, this.activeStorey);
      }
    },
    onLeave(storeyId) {
      if (this.timer) clearTimeout(this.timer);
      this.timer = setTimeout(() => {
        if (storeyId === this.activeStorey?.id) {
          this.activeStorey = null;
          this.hoverStorey = null;
        }
      }, 500);
    },
  },
  computed: {
    storeys() {
      if (!this.entrance) return [];
      const entries = Object.entries(this.entrance.storeys);
      const sorted = entries.sort((a, b) => b[0] - a[0]);
      return sorted.map((entry) => ({ id: entry[1], number: entry[0] }));
    },
  },
  components: {
    HousePlan,
  },
};
</script>

<style scoped>
.storey-popup {
  z-index: 10;
  padding: 16px;
  border-radius: 16px;
  background: #f5f5f5;
  backdrop-filter: blur(7px);
  color: theme("colors.gray");
  font-size: 14px;
  position: absolute;

  left: 16px;
  bottom: 35px;
}

@screen lg {
  .storey-popup {
    right: auto;
    left: 25px;
    top: 50%;
    transform: translateY(-50%);
    bottom: auto;
  }
}

@screen 2xl {
  .storey-popup {
    left: 100px;
  }
}
</style>
