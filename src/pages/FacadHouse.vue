<template>
  <div
    class="tw-h-screen tw-min-h-[700px] md:tw-min-h-[1000px] lg:tw-min-h-[800px] xl:tw-min-h-[800px] tw-overflow-hidden tw-relative tw-bg-primary">
    <Header class="tw-absolute tw-inset-x-0 tw-top-0" />
    <div
      class="tw-absolute tw-inset-0 tw-z-[5] tw-overflow-x-auto tw-pt-80 xl:tw-pt-[102px] tw-mb-[137px]">
      <div class="storey-popup" v-if="activeStorey">
        <div>
          <p class="tw-text-xl tw-text-secondary">
            {{ activeStorey.entrance }}
          </p>
          <p>секция</p>
        </div>
        <div>
          <p class="tw-text-xl tw-text-secondary">
            {{ activeStorey.number }}
          </p>
          <p>этаж</p>
        </div>
        <div>
          <p class="tw-text-xl tw-text-secondary">
            {{ activeStorey.flats_counters.free }}
          </p>
          <p>
            квартир <br />
            свободно
          </p>
        </div>
      </div>
      <HousePlan
        v-if="
          $grid.breakpoint === '' ||
          $grid.breakpoint === 'sm' ||
          $grid.breakpoint === 'md'
        "
        tappable
        :activeStorey="hoverStorey"
        :storeys="storeys"
        ratio="xMidYMid slice"
        d="M206 192.643V177.14L315.524 200.395L538 169V186.442L315.524 219L206 192.643Z"
        :paths="paths.mobile"
        width="1208"
        height="1080"
        :offset="17"
        :image="require('@/assets/images/house-mobile.jpg')"
        @enter="onEnter">
        <template #flags>
          <path d="M721 164L693.686 144.518C692.314 143.519 691.19 142.328 690.314 140.944C689.438 139.561 689 138.024 689 136.333L689 87.9167C689 86.0146 689.671 84.3863 691.014 83.0318C692.357 81.6773 693.971 81 695.857 81L746.143 81C748.029 81 749.643 81.6773 750.986 83.0318C752.329 84.3863 753 86.0146 753 87.9167L753 136.333C753 138.024 752.562 139.561 751.686 140.944C750.81 142.328 749.686 143.519 748.314 144.518L721 164Z" fill="#F5F5F5"/>
          <path d="M704.684 98.3408L705.894 98.498C705.762 99.332 705.423 99.986 704.876 100.46C704.333 100.929 703.666 101.164 702.873 101.164C701.879 101.164 701.08 100.84 700.473 100.193C699.872 99.5417 699.571 98.6097 699.571 97.3975C699.571 96.6136 699.701 95.9277 699.961 95.3398C700.221 94.752 700.615 94.3122 701.143 94.0205C701.677 93.7243 702.255 93.5762 702.88 93.5762C703.668 93.5762 704.313 93.7767 704.814 94.1777C705.316 94.5742 705.637 95.1393 705.778 95.873L704.582 96.0576C704.468 95.57 704.265 95.2031 703.973 94.957C703.686 94.7109 703.338 94.5879 702.928 94.5879C702.308 94.5879 701.804 94.8112 701.417 95.2578C701.029 95.6999 700.836 96.4017 700.836 97.3633C700.836 98.3385 701.023 99.0472 701.396 99.4893C701.77 99.9313 702.258 100.152 702.859 100.152C703.342 100.152 703.746 100.004 704.069 99.708C704.393 99.4118 704.598 98.9561 704.684 98.3408ZM711.637 98.6621L712.908 98.8193C712.708 99.5622 712.336 100.139 711.794 100.549C711.252 100.959 710.559 101.164 709.716 101.164C708.654 101.164 707.811 100.838 707.187 100.187C706.567 99.5303 706.257 98.612 706.257 97.4316C706.257 96.2103 706.571 95.2624 707.2 94.5879C707.829 93.9134 708.645 93.5762 709.648 93.5762C710.618 93.5762 711.411 93.9066 712.026 94.5674C712.642 95.2282 712.949 96.1579 712.949 97.3564C712.949 97.4294 712.947 97.5387 712.942 97.6846H707.528C707.574 98.4821 707.8 99.0928 708.205 99.5166C708.611 99.9404 709.117 100.152 709.723 100.152C710.174 100.152 710.559 100.034 710.878 99.7969C711.197 99.5599 711.45 99.1816 711.637 98.6621ZM707.597 96.6729H711.65C711.596 96.0622 711.441 95.6042 711.186 95.2988C710.794 94.8249 710.286 94.5879 709.661 94.5879C709.096 94.5879 708.62 94.777 708.233 95.1553C707.85 95.5335 707.638 96.0394 707.597 96.6729ZM714.173 93.7402H715.404V96.8779C715.796 96.8779 716.069 96.8027 716.224 96.6523C716.383 96.502 716.616 96.0645 716.921 95.3398C717.163 94.7656 717.359 94.3874 717.509 94.2051C717.66 94.0228 717.833 93.8997 718.029 93.8359C718.225 93.7721 718.539 93.7402 718.972 93.7402H719.218V94.7588L718.876 94.752C718.553 94.752 718.345 94.7998 718.254 94.8955C718.159 94.9958 718.013 95.2943 717.817 95.791C717.63 96.265 717.459 96.5931 717.304 96.7754C717.149 96.9577 716.91 97.124 716.586 97.2744C717.115 97.4157 717.634 97.9079 718.145 98.751L719.492 101H718.138L716.826 98.751C716.557 98.2998 716.322 98.0036 716.121 97.8623C715.921 97.7165 715.682 97.6436 715.404 97.6436V101H714.173V93.7402ZM720.046 93.7402H721.276V99.9883H724.68V93.7402H725.911V99.9883H726.704V103.058H725.692V101H720.046V93.7402ZM727.77 93.7402H729.001V99.2773L732.412 93.7402H733.738V101H732.508V95.4971L729.097 101H727.77V93.7402ZM741.026 93.7402V101H739.802V98.1699H739.091C738.658 98.1699 738.335 98.2269 738.12 98.3408C737.911 98.4502 737.603 98.8079 737.197 99.4141L736.124 101H734.6L735.926 99.0449C736.332 98.4479 736.735 98.1107 737.136 98.0332C736.434 97.9375 735.912 97.6846 735.571 97.2744C735.233 96.8643 735.065 96.3926 735.065 95.8594C735.065 95.2305 735.286 94.7201 735.728 94.3281C736.174 93.9362 736.819 93.7402 737.662 93.7402H741.026ZM739.802 94.7588H738.052C737.318 94.7588 736.844 94.8727 736.63 95.1006C736.42 95.3285 736.316 95.5951 736.316 95.9004C736.316 96.3333 736.471 96.6523 736.78 96.8574C737.095 97.0579 737.649 97.1582 738.442 97.1582H739.802V94.7588Z" fill="#9BA5B0"/>
          <path d="M723.048 112.8H724.416V138H721.428V116.292L715.632 118.632V115.68L723.048 112.8Z" fill="#18283A"/>
          <path d="M1072 200L1044.69 180.518C1043.31 179.519 1042.19 178.328 1041.31 176.944C1040.44 175.561 1040 174.024 1040 172.333L1040 123.917C1040 122.015 1040.67 120.386 1042.01 119.032C1043.36 117.677 1044.97 117 1046.86 117L1097.14 117C1099.03 117 1100.64 117.677 1101.99 119.032C1103.33 120.386 1104 122.015 1104 123.917L1104 172.333C1104 174.024 1103.56 175.561 1102.69 176.944C1101.81 178.328 1100.69 179.519 1099.31 180.518L1072 200Z" fill="#F5F5F5"/>
          <path d="M1055.68 134.341L1056.89 134.498C1056.76 135.332 1056.42 135.986 1055.88 136.46C1055.33 136.929 1054.67 137.164 1053.87 137.164C1052.88 137.164 1052.08 136.84 1051.47 136.193C1050.87 135.542 1050.57 134.61 1050.57 133.397C1050.57 132.614 1050.7 131.928 1050.96 131.34C1051.22 130.752 1051.61 130.312 1052.14 130.021C1052.68 129.724 1053.26 129.576 1053.88 129.576C1054.67 129.576 1055.31 129.777 1055.81 130.178C1056.32 130.574 1056.64 131.139 1056.78 131.873L1055.58 132.058C1055.47 131.57 1055.27 131.203 1054.97 130.957C1054.69 130.711 1054.34 130.588 1053.93 130.588C1053.31 130.588 1052.8 130.811 1052.42 131.258C1052.03 131.7 1051.84 132.402 1051.84 133.363C1051.84 134.339 1052.02 135.047 1052.4 135.489C1052.77 135.931 1053.26 136.152 1053.86 136.152C1054.34 136.152 1054.75 136.004 1055.07 135.708C1055.39 135.412 1055.6 134.956 1055.68 134.341ZM1062.64 134.662L1063.91 134.819C1063.71 135.562 1063.34 136.139 1062.79 136.549C1062.25 136.959 1061.56 137.164 1060.72 137.164C1059.65 137.164 1058.81 136.838 1058.19 136.187C1057.57 135.53 1057.26 134.612 1057.26 133.432C1057.26 132.21 1057.57 131.262 1058.2 130.588C1058.83 129.913 1059.64 129.576 1060.65 129.576C1061.62 129.576 1062.41 129.907 1063.03 130.567C1063.64 131.228 1063.95 132.158 1063.95 133.356C1063.95 133.429 1063.95 133.539 1063.94 133.685H1058.53C1058.57 134.482 1058.8 135.093 1059.21 135.517C1059.61 135.94 1060.12 136.152 1060.72 136.152C1061.17 136.152 1061.56 136.034 1061.88 135.797C1062.2 135.56 1062.45 135.182 1062.64 134.662ZM1058.6 132.673H1062.65C1062.6 132.062 1062.44 131.604 1062.19 131.299C1061.79 130.825 1061.29 130.588 1060.66 130.588C1060.1 130.588 1059.62 130.777 1059.23 131.155C1058.85 131.534 1058.64 132.039 1058.6 132.673ZM1065.17 129.74H1066.4V132.878C1066.8 132.878 1067.07 132.803 1067.22 132.652C1067.38 132.502 1067.62 132.064 1067.92 131.34C1068.16 130.766 1068.36 130.387 1068.51 130.205C1068.66 130.023 1068.83 129.9 1069.03 129.836C1069.22 129.772 1069.54 129.74 1069.97 129.74H1070.22V130.759L1069.88 130.752C1069.55 130.752 1069.35 130.8 1069.25 130.896C1069.16 130.996 1069.01 131.294 1068.82 131.791C1068.63 132.265 1068.46 132.593 1068.3 132.775C1068.15 132.958 1067.91 133.124 1067.59 133.274C1068.11 133.416 1068.63 133.908 1069.14 134.751L1070.49 137H1069.14L1067.83 134.751C1067.56 134.3 1067.32 134.004 1067.12 133.862C1066.92 133.716 1066.68 133.644 1066.4 133.644V137H1065.17V129.74ZM1071.05 129.74H1072.28V135.988H1075.68V129.74H1076.91V135.988H1077.7V139.058H1076.69V137H1071.05V129.74ZM1078.77 129.74H1080V135.277L1083.41 129.74H1084.74V137H1083.51V131.497L1080.1 137H1078.77V129.74ZM1092.03 129.74V137H1090.8V134.17H1090.09C1089.66 134.17 1089.33 134.227 1089.12 134.341C1088.91 134.45 1088.6 134.808 1088.2 135.414L1087.12 137H1085.6L1086.93 135.045C1087.33 134.448 1087.73 134.111 1088.14 134.033C1087.43 133.938 1086.91 133.685 1086.57 133.274C1086.23 132.864 1086.06 132.393 1086.06 131.859C1086.06 131.23 1086.29 130.72 1086.73 130.328C1087.17 129.936 1087.82 129.74 1088.66 129.74H1092.03ZM1090.8 130.759H1089.05C1088.32 130.759 1087.84 130.873 1087.63 131.101C1087.42 131.328 1087.32 131.595 1087.32 131.9C1087.32 132.333 1087.47 132.652 1087.78 132.857C1088.09 133.058 1088.65 133.158 1089.44 133.158H1090.8V130.759Z" fill="#9BA5B0"/>
          <path d="M1082.48 171.12V174H1063.58V171.84L1070.89 165.468C1074.28 162.516 1076.44 160.5 1077.37 159.42C1078.33 158.34 1078.81 157.188 1078.81 155.964C1078.81 154.572 1078.3 153.444 1077.26 152.58C1076.23 151.692 1074.85 151.248 1073.12 151.248C1071.4 151.248 1070 151.716 1068.95 152.652C1067.89 153.564 1067.18 154.86 1066.82 156.54H1063.8C1064.16 154.044 1065.19 152.064 1066.9 150.6C1068.6 149.136 1070.72 148.404 1073.27 148.404C1075.81 148.404 1077.86 149.112 1079.42 150.528C1081.01 151.944 1081.8 153.72 1081.8 155.856C1081.8 157.584 1081.22 159.144 1080.07 160.536C1078.94 161.904 1076.7 164.04 1073.34 166.944L1068.52 171.12H1082.48Z" fill="#18283A"/>
        </template>
      </HousePlan>
      <HousePlan
        v-else
        :activeStorey="hoverStorey"
        :storeys="storeys"
        ratio="xMidYMid slice"
        d="M1137 254.736V234.581L1296.01 264.814L1619 224V246.674L1296.01 289L1137 254.736Z"
        width="1920"
        height="720"
        :offset="22"
        :paths="paths.desktop"
        :image="require('@/assets/images/house-1.jpg')"
        @enter="onEnter"
        @leave="onLeave"
      >
        <template #flags>
          <path d="M871 103L843.686 83.5181C842.314 82.519 841.19 81.3278 840.314 79.9444C839.438 78.5611 839 77.0241 839 75.3333L839 26.9167C839 25.0146 839.671 23.3863 841.014 22.0318C842.357 20.6773 843.971 20 845.857 20L896.143 20C898.029 20 899.643 20.6773 900.986 22.0318C902.329 23.3863 903 25.0146 903 26.9167L903 75.3333C903 77.0241 902.562 78.5611 901.686 79.9444C900.81 81.3278 899.686 82.519 898.314 83.5181L871 103Z" fill="#F5F5F5"/>
          <path d="M854.684 37.3408L855.894 37.498C855.762 38.332 855.423 38.986 854.876 39.46C854.333 39.9294 853.666 40.1641 852.873 40.1641C851.879 40.1641 851.08 39.8405 850.473 39.1934C849.872 38.5417 849.571 37.6097 849.571 36.3975C849.571 35.6136 849.701 34.9277 849.961 34.3398C850.221 33.752 850.615 33.3122 851.143 33.0205C851.677 32.7243 852.255 32.5762 852.88 32.5762C853.668 32.5762 854.313 32.7767 854.814 33.1777C855.316 33.5742 855.637 34.1393 855.778 34.873L854.582 35.0576C854.468 34.57 854.265 34.2031 853.973 33.957C853.686 33.7109 853.338 33.5879 852.928 33.5879C852.308 33.5879 851.804 33.8112 851.417 34.2578C851.029 34.6999 850.836 35.4017 850.836 36.3633C850.836 37.3385 851.023 38.0472 851.396 38.4893C851.77 38.9313 852.258 39.1523 852.859 39.1523C853.342 39.1523 853.746 39.0042 854.069 38.708C854.393 38.4118 854.598 37.9561 854.684 37.3408ZM861.637 37.6621L862.908 37.8193C862.708 38.5622 862.336 39.1387 861.794 39.5488C861.252 39.959 860.559 40.1641 859.716 40.1641C858.654 40.1641 857.811 39.8382 857.187 39.1865C856.567 38.5303 856.257 37.612 856.257 36.4316C856.257 35.2103 856.571 34.2624 857.2 33.5879C857.829 32.9134 858.645 32.5762 859.648 32.5762C860.618 32.5762 861.411 32.9066 862.026 33.5674C862.642 34.2282 862.949 35.1579 862.949 36.3564C862.949 36.4294 862.947 36.5387 862.942 36.6846H857.528C857.574 37.4821 857.8 38.0928 858.205 38.5166C858.611 38.9404 859.117 39.1523 859.723 39.1523C860.174 39.1523 860.559 39.0339 860.878 38.7969C861.197 38.5599 861.45 38.1816 861.637 37.6621ZM857.597 35.6729H861.65C861.596 35.0622 861.441 34.6042 861.186 34.2988C860.794 33.8249 860.286 33.5879 859.661 33.5879C859.096 33.5879 858.62 33.777 858.233 34.1553C857.85 34.5335 857.638 35.0394 857.597 35.6729ZM864.173 32.7402H865.404V35.8779C865.796 35.8779 866.069 35.8027 866.224 35.6523C866.383 35.502 866.616 35.0645 866.921 34.3398C867.163 33.7656 867.359 33.3874 867.509 33.2051C867.66 33.0228 867.833 32.8997 868.029 32.8359C868.225 32.7721 868.539 32.7402 868.972 32.7402H869.218V33.7588L868.876 33.752C868.553 33.752 868.345 33.7998 868.254 33.8955C868.159 33.9958 868.013 34.2943 867.817 34.791C867.63 35.265 867.459 35.5931 867.304 35.7754C867.149 35.9577 866.91 36.124 866.586 36.2744C867.115 36.4157 867.634 36.9079 868.145 37.751L869.492 40H868.138L866.826 37.751C866.557 37.2998 866.322 37.0036 866.121 36.8623C865.921 36.7165 865.682 36.6436 865.404 36.6436V40H864.173V32.7402ZM870.046 32.7402H871.276V38.9883H874.68V32.7402H875.911V38.9883H876.704V42.0576H875.692V40H870.046V32.7402ZM877.77 32.7402H879.001V38.2773L882.412 32.7402H883.738V40H882.508V34.4971L879.097 40H877.77V32.7402ZM891.026 32.7402V40H889.802V37.1699H889.091C888.658 37.1699 888.335 37.2269 888.12 37.3408C887.911 37.4502 887.603 37.8079 887.197 38.4141L886.124 40H884.6L885.926 38.0449C886.332 37.4479 886.735 37.1107 887.136 37.0332C886.434 36.9375 885.912 36.6846 885.571 36.2744C885.233 35.8643 885.065 35.3926 885.065 34.8594C885.065 34.2305 885.286 33.7201 885.728 33.3281C886.174 32.9362 886.819 32.7402 887.662 32.7402H891.026ZM889.802 33.7588H888.052C887.318 33.7588 886.844 33.8727 886.63 34.1006C886.42 34.3285 886.316 34.5951 886.316 34.9004C886.316 35.3333 886.471 35.6523 886.78 35.8574C887.095 36.0579 887.649 36.1582 888.442 36.1582H889.802V33.7588Z" fill="#9BA5B0"/>
          <path d="M873.048 51.8H874.416V77H871.428V55.292L865.632 57.632V54.68L873.048 51.8Z" fill="#18283A"/>
          <path d="M1106 134L1078.69 114.518C1077.31 113.519 1076.19 112.328 1075.31 110.944C1074.44 109.561 1074 108.024 1074 106.333L1074 57.9167C1074 56.0146 1074.67 54.3863 1076.01 53.0318C1077.36 51.6773 1078.97 51 1080.86 51L1131.14 51C1133.03 51 1134.64 51.6773 1135.99 53.0318C1137.33 54.3863 1138 56.0146 1138 57.9167L1138 106.333C1138 108.024 1137.56 109.561 1136.69 110.944C1135.81 112.328 1134.69 113.519 1133.31 114.518L1106 134Z" fill="#F5F5F5"/>
          <path d="M1089.68 68.3408L1090.89 68.498C1090.76 69.332 1090.42 69.986 1089.88 70.46C1089.33 70.9294 1088.67 71.1641 1087.87 71.1641C1086.88 71.1641 1086.08 70.8405 1085.47 70.1934C1084.87 69.5417 1084.57 68.6097 1084.57 67.3975C1084.57 66.6136 1084.7 65.9277 1084.96 65.3398C1085.22 64.752 1085.61 64.3122 1086.14 64.0205C1086.68 63.7243 1087.26 63.5762 1087.88 63.5762C1088.67 63.5762 1089.31 63.7767 1089.81 64.1777C1090.32 64.5742 1090.64 65.1393 1090.78 65.873L1089.58 66.0576C1089.47 65.57 1089.27 65.2031 1088.97 64.957C1088.69 64.7109 1088.34 64.5879 1087.93 64.5879C1087.31 64.5879 1086.8 64.8112 1086.42 65.2578C1086.03 65.6999 1085.84 66.4017 1085.84 67.3633C1085.84 68.3385 1086.02 69.0472 1086.4 69.4893C1086.77 69.9313 1087.26 70.1523 1087.86 70.1523C1088.34 70.1523 1088.75 70.0042 1089.07 69.708C1089.39 69.4118 1089.6 68.9561 1089.68 68.3408ZM1096.64 68.6621L1097.91 68.8193C1097.71 69.5622 1097.34 70.1387 1096.79 70.5488C1096.25 70.959 1095.56 71.1641 1094.72 71.1641C1093.65 71.1641 1092.81 70.8382 1092.19 70.1865C1091.57 69.5303 1091.26 68.612 1091.26 67.4316C1091.26 66.2103 1091.57 65.2624 1092.2 64.5879C1092.83 63.9134 1093.64 63.5762 1094.65 63.5762C1095.62 63.5762 1096.41 63.9066 1097.03 64.5674C1097.64 65.2282 1097.95 66.1579 1097.95 67.3564C1097.95 67.4294 1097.95 67.5387 1097.94 67.6846H1092.53C1092.57 68.4821 1092.8 69.0928 1093.21 69.5166C1093.61 69.9404 1094.12 70.1523 1094.72 70.1523C1095.17 70.1523 1095.56 70.0339 1095.88 69.7969C1096.2 69.5599 1096.45 69.1816 1096.64 68.6621ZM1092.6 66.6729H1096.65C1096.6 66.0622 1096.44 65.6042 1096.19 65.2988C1095.79 64.8249 1095.29 64.5879 1094.66 64.5879C1094.1 64.5879 1093.62 64.777 1093.23 65.1553C1092.85 65.5335 1092.64 66.0394 1092.6 66.6729ZM1099.17 63.7402H1100.4V66.8779C1100.8 66.8779 1101.07 66.8027 1101.22 66.6523C1101.38 66.502 1101.62 66.0645 1101.92 65.3398C1102.16 64.7656 1102.36 64.3874 1102.51 64.2051C1102.66 64.0228 1102.83 63.8997 1103.03 63.8359C1103.22 63.7721 1103.54 63.7402 1103.97 63.7402H1104.22V64.7588L1103.88 64.752C1103.55 64.752 1103.35 64.7998 1103.25 64.8955C1103.16 64.9958 1103.01 65.2943 1102.82 65.791C1102.63 66.265 1102.46 66.5931 1102.3 66.7754C1102.15 66.9577 1101.91 67.124 1101.59 67.2744C1102.11 67.4157 1102.63 67.9079 1103.14 68.751L1104.49 71H1103.14L1101.83 68.751C1101.56 68.2998 1101.32 68.0036 1101.12 67.8623C1100.92 67.7165 1100.68 67.6436 1100.4 67.6436V71H1099.17V63.7402ZM1105.05 63.7402H1106.28V69.9883H1109.68V63.7402H1110.91V69.9883H1111.7V73.0576H1110.69V71H1105.05V63.7402ZM1112.77 63.7402H1114V69.2773L1117.41 63.7402H1118.74V71H1117.51V65.4971L1114.1 71H1112.77V63.7402ZM1126.03 63.7402V71H1124.8V68.1699H1124.09C1123.66 68.1699 1123.33 68.2269 1123.12 68.3408C1122.91 68.4502 1122.6 68.8079 1122.2 69.4141L1121.12 71H1119.6L1120.93 69.0449C1121.33 68.4479 1121.73 68.1107 1122.14 68.0332C1121.43 67.9375 1120.91 67.6846 1120.57 67.2744C1120.23 66.8643 1120.06 66.3926 1120.06 65.8594C1120.06 65.2305 1120.29 64.7201 1120.73 64.3281C1121.17 63.9362 1121.82 63.7402 1122.66 63.7402H1126.03ZM1124.8 64.7588H1123.05C1122.32 64.7588 1121.84 64.8727 1121.63 65.1006C1121.42 65.3285 1121.32 65.5951 1121.32 65.9004C1121.32 66.3333 1121.47 66.6523 1121.78 66.8574C1122.09 67.0579 1122.65 67.1582 1123.44 67.1582H1124.8V64.7588Z" fill="#9BA5B0"/>
          <path d="M1115.44 105.12V108H1096.54V105.84L1103.85 99.468C1107.24 96.516 1109.4 94.5 1110.33 93.42C1111.29 92.34 1111.77 91.188 1111.77 89.964C1111.77 88.572 1111.26 87.444 1110.22 86.58C1109.19 85.692 1107.81 85.248 1106.08 85.248C1104.36 85.248 1102.96 85.716 1101.91 86.652C1100.85 87.564 1100.14 88.86 1099.78 90.54H1096.76C1097.12 88.044 1098.15 86.064 1099.86 84.6C1101.56 83.136 1103.68 82.404 1106.23 82.404C1108.77 82.404 1110.82 83.112 1112.38 84.528C1113.97 85.944 1114.76 87.72 1114.76 89.856C1114.76 91.584 1114.18 93.144 1113.03 94.536C1111.9 95.904 1109.66 98.04 1106.3 100.944L1101.48 105.12H1115.44Z" fill="#18283A"/>
        </template>
      </HousePlan>
    </div>
    <Footer class="tw-absolute tw-inset-x-0 tw-bottom-0 tw-z-10" />
  </div>
</template>

<script>
import HousePlan from "@/components/HousePlan.vue";

export default {
  data() {
    return {
      entrance: null,
      storeysMap: new Map(),
      activeStorey: null,
      hoverStorey: null,
      timer: null,
      paths: {
        mobile: {
          first: [
            "M286.18 687.62L180.622 678.431L180.623 643.6L286.181 649.886L595.18 623.271L595.179 659.554L286.18 687.62Z",
            "M286.181 648.436L180.623 642.634L180.624 609.093L286.182 613.121L595.181 592.794L595.18 622.789L286.181 648.436Z",
            "M286.182 612.636L180.624 608.284L180.624 579.742L286.183 580.706L595.181 564.734L595.181 591.825L286.182 612.636Z",
            "M286.183 580.225L180.624 578.776L180.625 545.88L286.184 546.36L595.182 536.193L595.181 563.767L286.183 580.225Z",
            "M286.184 545.876L180.626 545.396L180.627 512.983L286.185 512.497L595.183 508.134L595.182 535.225L286.184 545.876Z",
            "M286.185 511.53L180.626 512.016L180.627 480.571L286.186 480.57L595.184 477.658L595.183 507.167L286.185 511.53Z",
            "M286.186 479.603L180.627 479.606L180.628 449.612L286.187 448.642L595.185 450.568L595.184 477.176L286.186 479.603Z",
            "M286.186 447.673L180.628 449.127L180.629 415.747L286.187 414.777L595.185 421.541L595.184 449.599L286.186 447.673Z",
            "M286.187 413.81L180.629 415.264L180.63 385.271L286.188 380.913L595.186 394.451L595.185 420.574L286.187 413.81Z",
            "M286.188 380.43L180.63 384.786L180.631 353.826L286.189 348.017L595.187 366.876L595.186 393.967L286.188 380.43Z",
            "M286.189 347.533L180.631 352.856L180.632 320.929L286.19 314.636L595.188 337.365L595.187 365.907L286.189 347.533Z",
            "M286.19 314.152L180.631 320.444L180.152 289.967L286.191 278.839L595.188 309.307L595.188 336.881L286.19 314.152Z",
            "M286.191 278.353L180.153 289.483L180.633 253.684L286.672 244.973L594.709 279.796L595.188 308.822L286.191 278.353Z",
            "M286.672 244.006L180.633 252.717L180.634 222.239L286.673 212.077L594.71 252.705L594.709 278.828L286.672 244.006Z",
            "M286.673 211.11L180.634 221.272L180.155 189.343L286.674 176.762L595.191 222.229L595.19 251.255L286.673 211.11Z",
            "M286.674 175.311L179.569 188.376L179.57 156.931L286.675 143.381L595.192 194.169L595.191 220.776L286.674 175.311Z",
            "M286.675 142.415L179.57 155.963L179.57 124.518L286.676 109.518L596.916 164.66L596.915 192.718L286.675 142.415Z",
            "M286.675 109.035L179.57 124.034L179.571 92.1066L286.676 73.7191L596.917 130.796L596.916 163.211L286.675 109.035Z",

            "M616.133 622.868V597.929L750.633 587.857V612.796L616.133 622.868Z",
            "M616.133 597.451V569.155L750.633 561.961V587.536L616.133 597.451Z",
            "M616.133 568.672V540.856L750.633 535.58V561.478L616.133 568.672Z",
            "M616.133 540.222V512.559L750.633 508.723V534.869L616.133 540.222Z",
            "M616.133 512.082V484.028L750.633 483.307V508.245L616.133 512.082Z",
            "M616.133 483.307V455.234L750.633 456.45V482.828L616.133 483.307Z",
            "M616.133 455.009V426.713L750.633 429.111V455.968L616.133 455.009Z",
            "M616.133 426.235V397.939L750.633 403.215V428.633L616.133 426.235Z",
            "M616.133 397.459V369.643L750.633 376.357V402.734L616.133 397.459Z",
            "M616.133 369.164V341.348L750.633 350.46V375.878L616.133 369.164Z",
            "M616.133 340.715V312.572L750.633 323.124V349.98L616.133 340.715Z",
            "M616.133 312.092V283.316L750.633 297.225V322.643L616.133 312.092Z",
            "M616.133 282.837V254.301L750.633 270.847V296.745L616.133 282.837Z",
            "M616.133 254.062V226.246L750.633 244.74V270.369L616.133 254.062Z",
            "M616.133 225.766V197.949L750.633 219.051V244.47L616.133 225.766Z",
            "M616.133 197.47V170.133L750.633 191.714V218.572L616.133 197.47Z",
            "M616.133 169.653V138L750.633 162.459V191.235L616.133 169.653Z",
          ],
          second: [],
        },
        desktop: {
          first: [
            "M689 715.999L579 706.499L579 670.499L689 676.999L1011 649.5L1011 687.001L689 715.999Z",
            "M689 675.5L579 669.5L579 634.834L689 639L1011 618L1011 649.001L689 675.5Z",
            "M689 638.501L579 634L579 604.5L689 605.5L1011 589L1011 617L689 638.501Z",
            "M689 605.001L579 603.501L579 569.501L689 570L1011 559.5L1011 588L689 605.001Z",
            "M689 569.5L579 569L579 535.5L689 535.001L1011 530.5L1011 558.5L689 569.5Z",
            "M689 534L579 534.5L579 502L689 502.001L1011 499L1011 529.5L689 534Z",
            "M689 501L579 501L579 470L689 469L1011 471L1011 498.5L689 501Z",
            "M689 468.001L579 469.5L579 435L689 434L1011 441L1011 470L689 468.001Z",
            "M689 433.001L579 434.5L579 403.501L689 399L1011 413.001L1011 440L689 433.001Z",
            "M689 398.501L579 403L579 371.001L689 365L1011 384.501L1011 412.501L689 398.501Z",
            "M689 364.501L579 370L579 337.001L689 330.5L1011 354.001L1011 383.501L689 364.501Z",
            "M689 330L579 336.5L578.5 305.001L689 293.502L1011 325.001L1011 353.5L689 330Z",
            "M689 293L578.5 304.5L579 267.5L689.5 258.499L1010.5 294.5L1011 324.5L689 293Z",
            "M689.5 257.5L579 266.5L579 235L689.5 224.5L1010.5 266.5L1010.5 293.5L689.5 257.5Z",
            "M689.5 223.5L579 234L578.5 201L689.5 188L1011 235L1011 265L689.5 223.5Z",
            "M689.5 186.5L577.889 200.001L577.889 167.501L689.5 153.5L1011 206L1011 233.5L689.5 186.5Z",
            "M689.5 152.5L577.889 166.5L577.889 134L689.5 118.5L1012.8 175.5L1012.8 204.5L689.5 152.5Z",
            "M689.5 118L577.889 133.5L577.889 100.501L689.5 81.4995L1012.8 140.5L1012.8 174.003L689.5 118Z",

            "M1032 649V623L1166.5 612.5V638.5L1032 649Z",
            "M1032 622.5V593L1166.5 585.5V612.163L1032 622.5Z",
            "M1032 592.5V563.5L1166.5 558V585L1032 592.5Z",
            "M1032 562.84V534L1166.5 530V557.259L1032 562.84Z",
            "M1032 533.5V504.252L1166.5 503.5V529.5L1032 533.5Z",
            "M1032 503.5V474.232L1166.5 475.5V503L1032 503.5Z",
            "M1032 474V444.5L1166.5 447V475L1032 474Z",
            "M1032 444V414.5L1166.5 420V446.5L1032 444Z",
            "M1032 414V385L1166.5 392V419.5L1032 414Z",
            "M1032 384.5V355.5L1166.5 365V391.5L1032 384.5Z",
            "M1032 354.84V325.5L1166.5 336.501V364.5L1032 354.84Z",
            "M1032 325V295L1166.5 309.5V336L1032 325Z",
            "M1032 294.5V264.75L1166.5 282V309L1032 294.5Z",
            "M1032 264.5V235.5L1166.5 254.78V281.5L1032 264.5Z",
            "M1032 235V206L1166.5 228V254.5L1032 235Z",
            "M1032 205.5V177L1166.5 199.5V227.5L1032 205.5Z",
            "M1032 176.5V143.5L1166.5 169V199L1032 176.5Z",
          ],
        },
      },
    };
  },
  created() {
    this.getEntrance();
  },
  methods: {
    async getEntrance() {
      this.entrance = await this.$store.dispatch("entrances/entrancesOne", {
        id: 1,
      });
    },
    async onEnter(storeyId) {
      this.hoverStorey = { id: storeyId };

      if (this.storeysMap.has(storeyId)) {
        this.activeStorey = this.storeysMap.get(storeyId);
      } else {
        this.activeStorey = await this.$store.dispatch("storeys/storeysOne", {
          id: storeyId,
        });
        this.storeysMap.set(storeyId, this.activeStorey);
      }
    },
    onLeave(storeyId) {
      if (this.timer) clearTimeout(this.timer);
      this.timer = setTimeout(() => {
        if (storeyId === this.activeStorey?.id) {
          this.activeStorey = null;
          this.hoverStorey = null;
        }
      }, 500);
    },
  },
  computed: {
    storeys() {
      if (!this.entrance) return [];
      const entries = Object.entries(this.entrance.storeys);
      const sorted = entries.sort((a, b) => b[0] - a[0]);
      return sorted.map((entry) => ({ id: entry[1], number: entry[0] }));
    },
  },
  components: {
    HousePlan,
  },
};
</script>

<style scoped>
.storey-popup {
  z-index: 10;
  padding: 16px;
  border-radius: 16px;
  background: #f5f5f5;
  backdrop-filter: blur(7px);
  color: theme("colors.gray");
  font-size: 14px;
  position: absolute;

  left: 16px;
  bottom: 35px;
}

@screen lg {
  .storey-popup {
    right: auto;
    left: 25px;
    top: 50%;
    transform: translateY(-50%);
    bottom: auto;
  }
}

@screen 2xl {
  .storey-popup {
    left: 100px;
  }
}
</style>
